<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON Data Table</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 8px;
            text-align: left;
            border: 1px solid #ddd;
        }
        .tree {
            cursor: pointer;
            font-weight: bold;
        }
        .nested {
            display: none;
        }
        .active {
            display: table-row;
        }
        .metadata-popup {
            display: none;
            position: absolute;
            background-color: #f9f9f9;
            border: 1px solid #ccc;
            padding: 10px;
            z-index: 1000;
        }
        .metadata-popup.active {
            display: block;
        }
        .metadata-btn {
            color: blue;
            text-decoration: underline;
            cursor: pointer;
        }
    </style>
</head>
<body>

<h2>JSON Data Table</h2>

<div id="data-table"></div>

<div id="metadata-popup" class="metadata-popup"></div>

<script src="data.js"></script> <!-- Load the JSON data -->
<script>
    function createTable(data) {
        const table = document.createElement('table');
        const headerRow = document.createElement('tr');

        // Define table headers
        const headers = ['Main', 'Type', 'Sub'];
        headers.forEach(headerText => {
            const header = document.createElement('th');
            header.textContent = headerText;
            headerRow.appendChild(header);
        });
        table.appendChild(headerRow);

        // Populate table with data
        data.forEach(item => {
            const row = document.createElement('tr');

            const mainCell = document.createElement('td');
            mainCell.textContent = item.main;
            mainCell.classList.add('tree');
            mainCell.addEventListener('click', function () {
                row.nextElementSibling.classList.toggle('active');
            });
            row.appendChild(mainCell);

            const typeCell = document.createElement('td');
            typeCell.textContent = item.Type;
            row.appendChild(typeCell);

            const subRow = document.createElement('tr');
            subRow.classList.add('nested');

            const subCell = document.createElement('td');
            const link = document.createElement('a');
            link.href = item.Link;
            link.textContent = item.Sub;
            link.target = "_blank";
            subCell.colSpan = headers.length;
            subCell.appendChild(link);

            const metadataBtn = document.createElement('span');
            metadataBtn.textContent = ' (Metadata)';
            metadataBtn.classList.add('metadata-btn');
            metadataBtn.addEventListener('click', function (event) {
                showPopup(event, item);
            });
            subCell.appendChild(metadataBtn);
            subRow.appendChild(subCell);

            table.appendChild(row);
            table.appendChild(subRow);
        });

        document.getElementById('data-table').appendChild(table);
    }

    // Function to show metadata pop-up
    function showPopup(event, item) {
        event.stopPropagation();
        const popup = document.getElementById('metadata-popup');
        let content = '';
        for (let key in item) {
            if (key !== 'main' && key !== 'Type' && key !== 'Sub' && key !== 'Link') {
                content += `<strong>${key}</strong>: ${item[key]}<br>`;
            }
        }
        popup.innerHTML = content;
        popup.style.left = event.pageX + 'px';
        popup.style.top = event.pageY + 'px';
        popup.classList.add('active');
    }

    // Hide popup when clicking outside
    document.addEventListener('click', function(event) {
        const popup = document.getElementById('metadata-popup');
        if (!event.target.closest('.metadata-btn')) {
            popup.classList.remove('active');
        }
    });

    // Initialize the table with JSON data
    createTable(jsonData);
</script>

</body>
</html>
